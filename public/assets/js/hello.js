function getAction(t,e){"LAMP"===t.elementType?t.withCrown?functions[e](t,lampParams(t)):functions[e](t,lampWithoutCrownParams(t)):"KINKIET"===t.elementType?functions[e](t,kinkietParams(t)):"OTHER"===t.elementType&&functions[e](t,{firstId:getElementId(t.current.other,"OTHER")})}function getElementId(t,e){return"COLUMN"===e?app.columns[t]["col.id"]:"CROWN"===e?app.crowns[t]["cro.id"]:"LAMP"===e?app.lamps[t]["lam.id"]:"KINKIET"===e?app.kinkiet[t]["kin.id"]:"OTHER"===e?app.others[t].id:void 0}function getStorageLang(){if(LANG)return LANG;if("undefined"!=typeof Storage){var t=localStorage.getItem("promar-site-lang");return t?t.toLowerCase():"pl"}return"pl"}function getTranslation(t){return dictionary[lang]&&dictionary[lang][t]?dictionary[lang][t]:t}function lampParams(t){return{firstId:getElementId(t.current.column,"COLUMN"),secondId:getElementId(t.current.crown,"CROWN"),thirdId:getElementId(t.current.lamp,"LAMP")}}function kinkietParams(t){return{firstId:getElementId(t.current.kinkiet,"KINKIET"),secondId:getElementId(t.current.lamp,"LAMP")}}function lampWithoutCrownParams(t){return{firstId:getElementId(t.current.column,"COLUMN"),secondId:getElementId(t.current.lamp,"LAMP")}}function paramsToUrl(t){var e=[];return _.each(t,function(t,n){e.push(n+"="+t)}),e.join("&")}function clearCanvas(t){t.preview=!1,t.chooser=!1,t.previewButtons=!1,t.current.lamp=0,t.current.kinkiet=0,t.current.crown=0,t.current.column=0,t.current.other=0}function fail(){}var lang=getStorageLang(),dictionary={},app=new Vue({data:{elementType:"LAMP",filter:{category:"CITY",connection:"UP"},current:{lamp:0,kinkiet:0,crown:0,column:0,other:0},email:"",name:"",emailMessage:"",emailFail:!1,mailSending:!1,mailSended:!1,withCrown:!1,chooser:!1,preview:!1,previewButtons:!1,columnsLoaded:!0,crownsLoaded:!0,kinkietLoaded:!0,lamps:[],sizes:[],others:[],crowns:[],kinkiet:[],columns:[],materials:[]},watch:{filter:{handler:function(t){this.getData(t)},deep:!0},elementType:function(){this.getData(this.filter)},current:{handler:function(){this.previewButtons=!0},deep:!0}},methods:{lampChanged:function(t){this.reloadAfterLampChange(t),this.current.lamp=t},otherChanged:function(t){this.current.other=t},crownChanged:function(t){this.reloadAfterCrownChange(t),this.current.crown=t},columnChanged:function(t){this.current.column=t},kinkietChanged:function(t){this.current.kinkiet=t},getData:function(t){"LAMP"===this.elementType?this.withCrown?this.getLamps(t):this.getLampsWithoutCrowns(t):"KINKIET"===this.elementType?this.getKinkiet(t):"OTHER"===this.elementType&&this.getOthers(t)},isLamp:function(){return"LAMP"===this.elementType},isNotLamp:function(){return!this.isLamp()},getLamps:function(t){clearCanvas(this),this.$http.get(BASE_URL+"api/lamps.json",{params:t}).then(function(t){this.chooser=!0,this.lamps=t.body.lamps,this.crowns=t.body.crowns,this.columns=t.body.columns,this.preview=t.body.preview},fail)},getLampsWithoutCrowns:function(t){clearCanvas(this),this.$http.get(BASE_URL+"api/lampcolumn.json",{params:t}).then(function(t){this.chooser=!0,this.lamps=t.body.lamps,this.columns=t.body.columns,this.preview=t.body.preview},fail)},getOthers:function(t){clearCanvas(this),this.$http.get(BASE_URL+"api/others.json",{params:_.omit(t,["connection","size","material"])}).then(function(t){this.chooser=!0,this.others=t.body.others,this.preview=t.body.preview},fail)},getKinkiet:function(t){clearCanvas(this),this.$http.get(BASE_URL+"api/kinkiet.json",{params:_.omit(t,["size","material"])}).then(function(t){this.chooser=!0,this.lamps=t.body.lamps,this.kinkiet=t.body.kinkiet,this.preview=t.body.preview},fail)},getPdf:function(){this.pdfNotLoad=!1,getAction(this,"getPdf")},getPreview:function(){this.preview=!1,getAction(this,"getPreview")},sendMail:function(){this.email?(this.emailFail=!1,this.mailSending=!0,getAction(this,"sendMail")):this.emailFail=!0},getConfiguration:function(){this.$http.get(BASE_URL+"api/config.json").then(function(t){dictionary=t.body.dictionary,this.sizes=t.body.sizes,this.materials=t.body.materials,this.filter.size=t.body.defaultSize,this.filter.material=t.body.defaultMaterial,app.$mount("#vueApp")},fail)},changedFilter:function(){var t=this;Vue.nextTick(function(){t.getData(t.filter)})},isCity:function(){return"CITY"===this.filter.category},isHome:function(){return"HOME"===this.filter.category},dict:function(t){return getTranslation(t)},clearEmailForm:function(){this.name="",this.email="",this.emailMessage="",this.mailSending=!1,this.mailSended=!1},reloadAfterCrownChange:function(t){this.columnsLoaded=!1;var e=_.extend(_.clone(this.filter),{crownId:getElementId(t,"CROWN")});this.$http.get(BASE_URL+"api/lamps.json",{params:e}).then(function(t){this.columnsLoaded=!0,this.current.lamp=0,this.columns=t.body.columns},fail)},reloadAfterLampChange:function(t){this.columnsLoaded=!1,this.crownsLoaded=!1,this.kinkietLoaded=!1;var e=_.extend(_.clone(this.filter),{lampId:getElementId(t,"LAMP")}),n="api/lampcolumn.json";"LAMP"===this.elementType&&this.withCrown?n="api/lamps.json":"KINKIET"===this.elementType&&(n="api/kinkiet.json"),this.$http.get(BASE_URL+n,{params:e}).then(function(t){this.columnsLoaded=!0,this.crownsLoaded=!0,this.kinkietLoaded=!0,this.current.kinkiet=0,this.current.crown=0,this.current.column=0,this.crowns=t.body.crowns||[],this.kinkiet=t.body.kinkiet||[],this.columns=t.body.columns||[]},fail)}},filters:{dict:function(t){return getTranslation(t)}},components:{"carousel-3d":Carousel3d.Carousel3d,slide:Carousel3d.Slide}});app.getConfiguration(),app.getLampsWithoutCrowns();var functions={getPdf:function(t,e){window.open(BASE_URL+"api/pdf.php?"+paramsToUrl(e))},getPreview:function(t,e){t.$http.get(BASE_URL+"api/preview.json",{params:e}).then(function(e){t.preview=e.body.preview},fail)},sendMail:function(t,e){t.$http.get(BASE_URL+"api/sendmail.json",{params:_.extend(e,{email:t.email,name:t.name,message:t.emailMessage})}).then(function(e){t.mailSending=!1,t.mailSended="ok"===e.body.result},fail)}};